+function($){var xEditor=function(element,option){this.$range=null;this.$plugsBarButtonSelected=null;this.$element=element;this.$defaults={uploadUrl:"http://127.0.0.1:8000/api/upload",plugs:[{index:0,title:"字体",icon:["remixicon-text","remixicon-text"],command:"fontName",value:"微软雅黑",extend:{name:"select",parameters:{preSet:[{name:"微软雅黑",value:"微软雅黑"},{name:"黑体",value:"黑体"},{name:"宋体",value:"宋体"},{name:"Arial",value:"Arial"}]}}},{index:1,title:"字号",icon:["remixicon-font-size","remixicon-font-size"],command:"fontSize",value:1,extend:{name:"select",parameters:{preSet:[{name:1,value:1},{name:2,value:2},{name:3,value:3},{name:4,value:4},{name:5,value:5},{name:6,value:6},{name:7,value:7}]}}},{index:2,title:"字体颜色",icon:["remixicon-font-color","remixicon-font-color"],command:"foreColor",value:"#194d33",extend:{name:"color",parameters:{mousedown:false,color:{h:0,l:"100%",s:"50%",r:0,g:0,b:0,a:1},target:null,x:230,y:45,preSet:[{r:208,g:2,b:27,a:1},{r:245,g:166,b:35,a:1},{r:248,g:231,b:28,a:1},{r:139,g:87,b:42,a:1},{r:126,g:211,b:33,a:1},{r:65,g:117,b:5,a:1},{r:189,g:16,b:224,a:1},{r:144,g:19,b:254,a:1},{r:74,g:144,b:226,a:1},{r:80,g:227,b:194,a:1},{r:184,g:233,b:134,a:1},{r:0,g:0,b:0,a:1},{r:74,g:74,b:74,a:1},{r:155,g:155,b:155,a:1},{r:255,g:255,b:255,a:1},{r:0,g:0,b:0,a:0}]}}},{index:3,title:"背景颜色",icon:["remixicon-input-method-fill","remixicon-input-method-fill"],command:"hiliteColor",value:"#194d33",extend:{name:"color",parameters:{mousedown:false,color:{h:0,l:"100%",s:"50%",r:0,g:0,b:0,a:1},target:null,x:230,y:45,preSet:[{r:208,g:2,b:27,a:1},{r:245,g:166,b:35,a:1},{r:248,g:231,b:28,a:1},{r:139,g:87,b:42,a:1},{r:126,g:211,b:33,a:1},{r:65,g:117,b:5,a:1},{r:189,g:16,b:224,a:1},{r:144,g:19,b:254,a:1},{r:74,g:144,b:226,a:1},{r:80,g:227,b:194,a:1},{r:184,g:233,b:134,a:1},{r:0,g:0,b:0,a:1},{r:74,g:74,b:74,a:1},{r:155,g:155,b:155,a:1},{r:255,g:255,b:255,a:1},{r:0,g:0,b:0,a:0}]}}},{index:4,title:"粗体",icon:["remixicon-bold","remixicon-bold"],command:"bold",value:null,extend:{}},{index:5,title:"斜体",icon:["remixicon-italic","remixicon-italic"],command:"italic",value:null,extend:{}},{index:6,title:"下划线",icon:["remixicon-underline","remixicon-underline"],command:"underline",value:null,extend:{}},{index:7,title:"上标",icon:["remixicon-superscript","remixicon-superscript"],command:"superscript",value:null,extend:{}},{index:8,title:"下标",icon:["remixicon-subscript","remixicon-subscript"],command:"subscript",value:null,extend:{}},{index:9,title:"标签",icon:["remixicon-price-tag-3-line","remixicon-price-tag-3-line"],command:"tag",value:null,extend:{}},{index:10,title:"引用",icon:["remixicon-double-quotes-l","remixicon-double-quotes-l"],command:"quote",value:null,extend:{}},{index:11,title:"左缩进",icon:["remixicon-indent-decrease","remixicon-indent-decrease"],command:"outdent",value:null,extend:{}},{index:12,title:"右缩进",icon:["remixicon-indent-increase","remixicon-indent-increase"],command:"indent",value:null,extend:{}},{index:13,title:"水平线",icon:["remixicon-separator","remixicon-separator"],command:"insertHorizontalRule",value:null,extend:{}},{index:14,title:"代码段",icon:["remixicon-code-view","remixicon-code-view"],command:"code",value:"text/x-php",extend:{name:"select",parameters:{preSet:[{name:"APL",value:"text/apl"},{name:"PGP",value:"application/pgp"},{name:"ASN.1",value:"text/x-ttcn-asn"},{name:"Asterisk",value:"text/x-asterisk"},{name:"Brainfuck",value:"text/x-brainfuck"},{name:"C",value:"text/x-csrc"},{name:"C++",value:"text/x-c++src"},{name:"Cobol",value:"text/x-cobol"},{name:"C#",value:"text/x-csharp"},{name:"Clojure",value:"text/x-clojure"},{name:"ClojureScript",value:"text/x-clojurescript"},{name:"Closure Stylesheets (GSS)",value:"text/x-gss"},{name:"CMake",value:"text/x-cmake"},{name:"CoffeeScript",value:"text/x-coffeescript"},{name:"Common Lisp",value:"text/x-common-lisp"},{name:"Cypher",value:"application/x-cypher-query"},{name:"Cython",value:"text/x-cython"},{name:"Crystal",value:"text/x-crystal"},{name:"CSS",value:"text/css"},{name:"CQL",value:"text/x-cassandra"},{name:"D",value:"text/x-d"},{name:"Dart",value:"text/x-dart"},{name:"diff",value:"text/x-diff"},{name:"Django",value:"text/x-django"},{name:"Dockerfile",value:"text/x-dockerfile"},{name:"DTD",value:"application/xml-dtd"},{name:"Dylan",value:"text/x-dylan"},{name:"EBNF",value:"text/x-ebnf"},{name:"ECL",value:"text/x-ecl"},{name:"edn",value:"application/edn"},{name:"Eiffel",value:"text/x-eiffel"},{name:"Elm",value:"text/x-elm"},{name:"Embedded Javascript",value:"application/x-ejs"},{name:"Embedded Ruby",value:"application/x-erb"},{name:"Erlang",value:"text/x-erlang"},{name:"Esper",value:"text/x-esper"},{name:"Factor",value:"text/x-factor"},{name:"FCL",value:"text/x-fcl"},{name:"Forth",value:"text/x-forth"},{name:"Fortran",value:"text/x-fortran"},{name:"F#",value:"text/x-fsharp"},{name:"Gas",value:"text/x-gas"},{name:"Gherkin",value:"text/x-feature"},{name:"GitHub Flavored Markdown",value:"text/x-gfm"},{name:"Go",value:"text/x-go"},{name:"Groovy",value:"text/x-groovy"},{name:"HAML",value:"text/x-haml"},{name:"Haskell",value:"text/x-haskell"},{name:"Haskell (Literate)",value:"text/x-literate-haskell"},{name:"Haxe",value:"text/x-haxe"},{name:"HXML",value:"text/x-hxml"},{name:"ASP.NET",value:"application/x-aspx"},{name:"HTML",value:"text/html"},{name:"HTTP",value:"message/http"},{name:"IDL",value:"text/x-idl"},{name:"Pug",value:"text/x-pug"},{name:"Java",value:"text/x-java"},{name:"Java Server Pages",value:"application/x-jsp"},{name:"JavaScript",value:"text/javascript"},{name:"JSON",value:"application/x-json"},{name:"JSON-LD",value:"application/ld+json"},{name:"JSX",value:"text/jsx"},{name:"Jinja2",value:"text/jinja2"},{name:"Julia",value:"text/x-julia"},{name:"Kotlin",value:"text/x-kotlin"},{name:"LESS",value:"text/x-less"},{name:"LiveScript",value:"text/x-livescript"},{name:"Lua",value:"text/x-lua"},{name:"Markdown",value:"text/x-markdown"},{name:"mIRC",value:"text/mirc"},{name:"MariaDB SQL",value:"text/x-mariadb"},{name:"Mathematica",value:"text/x-mathematica"},{name:"Modelica",value:"text/x-modelica"},{name:"MUMPS",value:"text/x-mumps"},{name:"MS SQL",value:"text/x-mssql"},{name:"mbox",value:"application/mbox"},{name:"MySQL",value:"text/x-mysql"},{name:"Nginx",value:"text/x-nginx-conf"},{name:"NSIS",value:"text/x-nsis"},{name:"NTriples",value:"text/n-triples"},{name:"Objective-C",value:"text/x-objectivec"},{name:"OCaml",value:"text/x-ocaml"},{name:"Octave",value:"text/x-octave"},{name:"Oz",value:"text/x-oz"},{name:"Pascal",value:"text/x-pascal"},{name:"PEG.js",value:"null"},{name:"Perl",value:"text/x-perl"},{name:"PHP",value:"text/x-php"},{name:"Pig",value:"text/x-pig"},{name:"Plain Text",value:"text/plain"},{name:"PLSQL",value:"text/x-plsql"},{name:"PostgreSQL",value:"text/x-pgsql"},{name:"PowerShell",value:"application/x-powershell"},{name:"Properties files",value:"text/x-properties"},{name:"ProtoBuf",value:"text/x-protobuf"},{name:"Python",value:"text/x-python"},{name:"Puppet",value:"text/x-puppet"},{name:"Q",value:"text/x-q"},{name:"R",value:"text/x-rsrc"},{name:"reStructuredText",value:"text/x-rst"},{name:"RPM Changes",value:"text/x-rpm-changes"},{name:"RPM Spec",value:"text/x-rpm-spec"},{name:"Ruby",value:"text/x-ruby"},{name:"Rust",value:"text/x-rustsrc"},{name:"SAS",value:"text/x-sas"},{name:"Sass",value:"text/x-sass"},{name:"Scala",value:"text/x-scala"},{name:"Scheme",value:"text/x-scheme"},{name:"SCSS",value:"text/x-scss"},{name:"Shell",value:"text/x-sh"},{name:"Sieve",value:"application/sieve"},{name:"Slim",value:"text/x-slim"},{name:"Smalltalk",value:"text/x-stsrc"},{name:"Smarty",value:"text/x-smarty"},{name:"Solr",value:"text/x-solr"},{name:"SML",value:"text/x-sml"},{name:"Soy",value:"text/x-soy"},{name:"SPARQL",value:"application/sparql-query"},{name:"Spreadsheet",value:"text/x-spreadsheet"},{name:"SQL",value:"text/x-sql"},{name:"SQLite",value:"text/x-sqlite"},{name:"Squirrel",value:"text/x-squirrel"},{name:"Stylus",value:"text/x-styl"},{name:"Swift",value:"text/x-swift"},{name:"sTeX",value:"text/x-stex"},{name:"LaTeX",value:"text/x-latex"},{name:"SystemVerilog",value:"text/x-systemverilog"},{name:"Tcl",value:"text/x-tcl"},{name:"Textile",value:"text/x-textile"},{name:"TiddlyWiki ",value:"text/x-tiddlywiki"},{name:"Tiki wiki",value:"text/tiki"},{name:"TOML",value:"text/x-toml"},{name:"Tornado",value:"text/x-tornado"},{name:"troff",value:"text/troff"},{name:"TTCN",value:"text/x-ttcn"},{name:"TTCN_CFG",value:"text/x-ttcn-cfg"},{name:"Turtle",value:"text/turtle"},{name:"TypeScript",value:"application/typescript"},{name:"TypeScript-JSX",value:"text/typescript-jsx"},{name:"Twig",value:"text/x-twig"},{name:"Web IDL",value:"text/x-webidl"},{name:"VB.NET",value:"text/x-vb"},{name:"VBScript",value:"text/vbscript"},{name:"Velocity",value:"text/velocity"},{name:"Verilog",value:"text/x-verilog"},{name:"VHDL",value:"text/x-vhdl"},{name:"Vue.js Component",value:"text/x-vue"},{name:"XML",value:"text/xml"},{name:"XQuery",value:"application/xquery"},{name:"Yacas",value:"text/x-yacas"},{name:"YAML",value:"text/x-yaml"},{name:"Z80",value:"text/x-z80"},{name:"mscgen",value:"text/x-mscgen"},{name:"xu",value:"text/x-xu"},{name:"msgenny",value:"text/x-msgenny"}],target:{xEditorCode:[]}}}},{index:15,title:"图片",icon:["remixicon-image-line","remixicon-image-line"],command:"image",value:"",extend:{name:"image",parameters:{preSet:[{name:1,value:1},{name:2,value:2},{name:3,value:3},{name:4,value:4},{name:5,value:5},{name:6,value:6},{name:7,value:7}],target:null}}},{index:16,title:"有序列表",icon:["remixicon-list-ordered","remixicon-list-ordered"],command:"insertOrderedList",value:null,extend:{}},{index:17,title:"无序列表",icon:["remixicon-list-unordered","remixicon-list-unordered"],command:"insertUnorderedList",value:null,extend:{}},{index:18,title:"两端对齐",icon:["remixicon-align-justify","remixicon-align-justify"],command:"justifyFull",value:null,extend:{}},{index:19,title:"左对齐",icon:["remixicon-align-left","remixicon-align-left"],command:"justifyLeft",value:null,extend:{}},{index:20,title:"居中对齐",icon:["remixicon-align-center","remixicon-align-center"],command:"justifyCenter",value:null,extend:{}},{index:21,title:"右对齐",icon:["remixicon-align-right","remixicon-align-right"],command:"justifyRight",value:null,extend:{}},{index:22,title:"清除格式",icon:["remixicon-format-clear","remixicon-format-clear"],command:"removeFormat",value:null,extend:{}},{index:23,title:"添加链接",icon:["remixicon-link-m","remixicon-link-m"],command:"createLink",value:"",extend:{name:"input",parameters:{preSet:[],target:null}}},{index:24,title:"清除链接",icon:["remixicon-link-unlink-m","remixicon-link-unlink-m"],command:"unlink",value:null,extend:{}},{index:25,title:"预览",icon:["remixicon-eye-line","remixicon-eye-off-line"],command:"preview",value:null,extend:{}},{index:26,title:"全屏",icon:["remixicon-fullscreen-line","remixicon-fullscreen-exit-line"],command:"fullScreen",value:null,extend:{}}]};this.$option=$.extend(true,this.$defaults,option);this.$init(this)};xEditor.prototype={$xEditorContentPaste:function(_this,event){var selection=window.getSelection();if(this.$range=selection.getRangeAt(0)){if(event.clipboardData||event.originalEvent){var clipboardData=event.clipboardData||event.originalEvent.clipboardData;if(clipboardData.items){var items=clipboardData.items;var len=items.length;var blob=null;for(var i=0;i<len;i++){if(items[i].type.indexOf("image")!==-1){blob=items[i].getAsFile();if(blob!==null){var url=_this.$xEditorPlugUpload(_this,blob,"file");var image=new Image;image.src=url;image.onload=function(){document.execCommand("insertHTML",false,'<img style="width: '+image.width/window.devicePixelRatio+"px; height: "+image.height/window.devicePixelRatio+'px;" src="'+url+'">')}}}}}}}},$xEditorPlugImageInit:function(_this,extend,item){var image=$('<div style="text-align: justify; height: 180px;"></div>');$(extend).children().eq(1).append(image);item.extend.parameters.target={image:$('<div style="display: inline-block; float: left; width: 180px; height: 180px; border: 1px dashed #dcdee2; background-position: center; background-repeat: no-repeat; background-size: cover;"></div>'),previewButton:$('<button style="display: inline-block; float: right; width: 50px; height: 20px; background-color: #19be6b; color: #fff; font-size: 12px; line-height: 20px; border: none; cursor: pointer; outline: none;">浏览</button>'),file:$('<input hidden type="file">')};$(image).append(item.extend.parameters.target.image);$(image).append(item.extend.parameters.target.previewButton);$(image).append(item.extend.parameters.target.file);$(item.extend.parameters.target.previewButton).click(function(event){$(item.extend.parameters.target.file).click()});$(item.extend.parameters.target.file).change(function(event){var fileReader=new FileReader;fileReader.readAsDataURL(this.files[0]);fileReader.onload=function(e){$(item.extend.parameters.target.image).css({backgroundImage:"url("+e.target.result+")"})}})},$xEditorPlugInputInit:function(_this,extend,item){var input=$('<input style="width: 100%; height: 24px; border-radius: 2px; border: 1px solid #dcdee2; color: #2b85e4; outline: none; background-color: #fff;">');$(extend).children().eq(1).append(input);$(input).change(function(event){var index=$(this).closest("li").index();_this.$option.plugs[index]["value"]=$(this).val()})},$xEditorPlugColorTargetPreSetChildren:function(_this,item,event){var color=$(event.target).css("backgroundColor").replace(")","").split("(")[1].split(",").map(function(item){return parseInt(item)});item.extend.parameters.color.r=color[0];item.extend.parameters.color.g=color[1];item.extend.parameters.color.b=color[2];if(color.length>3){item.extend.parameters.color.a=color[3]}else{item.extend.parameters.color.a=1}_this.$xEditorPlugColorOutput(_this,item,false)},$xEditorPlugColorTargetBarAreaAlpha:function(_this,item,event){if(event.offsetX>=0&&event.offsetX<=$(item.extend.parameters.target.barAreaAlpha).width()+5){$(item.extend.parameters.target.barAreaAlphaDrag).css({left:event.offsetX-2});var x=event.offsetX;if(x<0){x=0}if(x>$(item.extend.parameters.target.barAreaAlpha).width()){x=$(item.extend.parameters.target.barAreaAlpha).width()}item.extend.parameters.color.a=1-x/$(item.extend.parameters.target.barAreaAlpha).width();_this.$xEditorPlugColorOutput(_this,item,true)}},$xEditorPlugColorTargetBarAreaColor:function(_this,item,event){if(event.offsetX>=0&&event.offsetX<=$(item.extend.parameters.target.barAreaColor).width()+4){$(item.extend.parameters.target.barAreaColorDrag).css({left:event.offsetX+5});var x=event.offsetX;if(x<0){x=0}if(x>$(item.extend.parameters.target.barAreaColor).width()){x=$(item.extend.parameters.target.barAreaColor).width()}item.extend.parameters.color.h=x*360/$(item.extend.parameters.target.barAreaColor).width();_this.$xEditorPlugColorOutput(_this,item,true)}},$xEditorPlugColorTargetPanel:function(_this,item,event){if(event.offsetX>=0&&event.offsetX<=$(item.extend.parameters.target.panel).width()&&event.offsetY>=0&&event.offsetY<=$(item.extend.parameters.target.panel).height()){$(item.extend.parameters.target.panelDrag).css({left:event.offsetX+3,top:event.offsetY+34});item.extend.parameters.x=event.offsetX+3;item.extend.parameters.y=event.offsetY+34;_this.$xEditorPlugColorOutput(_this,item,true)}},$xEditorPlugColorOutput:function(_this,item,computer){if(computer){var rgb=tinycolor({h:item.extend.parameters.color.h,s:(item.extend.parameters.x-$(item.extend.parameters.target.panel).position().left)*100/$(item.extend.parameters.target.panel).width(),v:(1-(item.extend.parameters.y-$(item.extend.parameters.target.panel).position().top)/$(item.extend.parameters.target.panel).height())*100}).toRgb();item.extend.parameters.color.r=rgb.r;item.extend.parameters.color.g=rgb.g;item.extend.parameters.color.b=rgb.b}$(item.extend.parameters.target.panel).css({backgroundColor:"hsl("+[item.extend.parameters.color.h,item.extend.parameters.color.l,item.extend.parameters.color.s].join(",")+")"});var index=$(this).closest("li").index();if(item.extend.parameters.color.r==0&&item.extend.parameters.color.g==0&&item.extend.parameters.color.b==0&&item.extend.parameters.color.a==0){$(item.extend.parameters.target.barSelected).css({backgroundColor:"",backgroundPosition:"center",backgroundSize:"cover",backgroundImage:'url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMElEQVQ4T2N89uzZfwY8QFJSEp80A+OoAcMiDP7//483HTx//hx/Ohg1gIFx6IcBALl+VXknOCvFAAAAAElFTkSuQmCC")'});item["value"]="rgba(0,0,0,0)"}else{$(item.extend.parameters.target.barSelected).css({backgroundImage:"",backgroundPosition:"",backgroundSize:"",backgroundColor:"rgba("+[item.extend.parameters.color.r,item.extend.parameters.color.g,item.extend.parameters.color.b,item.extend.parameters.color.a].join(",")+")"});item["value"]="rgba("+[item.extend.parameters.color.r,item.extend.parameters.color.g,item.extend.parameters.color.b,item.extend.parameters.color.a].join(",")+")"}},$xEditorPlugColorInit:function(_this,extend,item){var color=$("<div></div>");var panel=$('<div style="outline: 1px solid #dcdee2;height: 238px; width: 238px;cursor: pointer;background: linear-gradient(to bottom, transparent, #000), linear-gradient(to right, #fff, transparent);background-color: hsl(0, 100%, 50%);"></div>');var panelDrag=$('<div style="position: absolute;width: 6px;height: 6px;border: 1px solid #fff;border-radius: 100%;"></div>');panel.append(panelDrag);color.append(panel);var bar=$('<div style="height: 30px;padding: 20px 0px;text-align: center;"></div>');var barArea=$('<div style="display: inline-block;width: 180px;height: 24px;float: left;"></div>');var barAreaColor=$('<div style="outline: 1px solid #dcdee2;height: 8px;width: 206px;background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);"></div>');var barAreaColorDrag=$('<div style="cursor: ew-resize;position: absolute;margin-top: -2px;width: 4px;height: 10px;border: 1px solid #dcdee2;background-color: #fff;"></div>');$(barAreaColor).append(barAreaColorDrag);var barAreaImage=$("<div style=\"height: 8px;width: 206px;background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMElEQVQ4T2N89uzZfwY8QFJSEp80A+OoAcMiDP7//483HTx//hx/Ohg1gIFx6IcBALl+VXknOCvFAAAAAElFTkSuQmCC');margin-top: 8px;\"></div>");var barAreaAlpha=$('<div style="outline: 1px solid #dcdee2;position: absolute;height: 8px;width: 206px;margin-top: -8px;background: linear-gradient(to right, rgb(141, 121, 49) 0%, rgba(141, 121, 49, 0) 100%);"></div>');var barAreaAlphaDrag=$('<div style="cursor: ew-resize;position: absolute;margin-top: -2px;width: 4px;height: 10px;border: 1px solid #dcdee2;background-color: #fff;"></div>');$(barAreaAlpha).append(barAreaAlphaDrag);$(barArea).append(barAreaColor);$(barArea).append(barAreaImage);$(barArea).append(barAreaAlpha);var barSelected=$('<div style="outline: 1px solid #dcdee2;display: inline-block;float: right;width: 24px;height: 24px;background-color: blue;right: 0px;"></div>');$(bar).append(barArea);$(bar).append(barSelected);var preSet=$('<div style="text-align: justify;width: 248px;font-size: 0px;"></div>');item.extend.parameters.preSet.forEach(function(option,i){if(++i!=item.extend.parameters.preSet.length){$(preSet).append('<div style="outline: 1px solid #dcdee2;margin-bottom: 10px; margin-right: 12px;display: inline-block;width: 19px;height: 20px;background-color: rgba('+option.r+","+option.g+","+option.b+","+option.a+')"></div>')}else{$(preSet).append('<div style="outline: 1px solid #dcdee2;margin-bottom: 10px; margin-right: 12px;display: inline-block;width: 19px;height: 20px;background-color: rgba('+option.r+","+option.g+","+option.b+","+option.a+");background-position: center;background-size: cover;background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMElEQVQ4T2N89uzZfwY8QFJSEp80A+OoAcMiDP7//483HTx//hx/Ohg1gIFx6IcBALl+VXknOCvFAAAAAElFTkSuQmCC');\"></div>")}});$(extend).children().eq(1).append(color);$(extend).children().eq(1).append(bar);$(extend).children().eq(1).append(preSet);item.extend.parameters.target={panel:$(panel),panelDrag:$(panelDrag),barAreaColor:$(barAreaColor),barAreaColorDrag:$(barAreaColorDrag),barAreaAlpha:$(barAreaAlpha),barAreaAlphaDrag:$(barAreaAlphaDrag),barSelected:$(barSelected),preSet:$(preSet)};_this.$xEditorPlugColorOutput(_this,item,true);$(item.extend.parameters.target.panelDrag).css({left:item.extend.parameters.x+"px",top:item.extend.parameters.y+"px"});$(item.extend.parameters.target.panel).click(function(event){if(this==event.target){_this.$xEditorPlugColorTargetPanel(_this,item,event)}});$(item.extend.parameters.target.barAreaColor).click(function(event){if(this==event.target){_this.$xEditorPlugColorTargetBarAreaColor(_this,item,event)}});$(item.extend.parameters.target.barAreaAlpha).click(function(event){if(this==event.target){_this.$xEditorPlugColorTargetBarAreaAlpha(_this,item,event)}});$(item.extend.parameters.target.preSet).children().click(function(event){if(this==event.target){_this.$xEditorPlugColorTargetPreSetChildren(_this,item,event)}});$(document).mousedown(function(event){item.extend.parameters.mousedown=true;$(item.extend.parameters.target.panel).mousemove(function(event){if(item.extend.parameters.mousedown&&this==event.target){_this.$xEditorPlugColorTargetPanel(_this,item,event)}});$(item.extend.parameters.target.barAreaColor).mousemove(function(event){if(item.extend.parameters.mousedown&&this==event.target){_this.$xEditorPlugColorTargetBarAreaColor(_this,item,event)}});$(item.extend.parameters.target.barAreaAlpha).mousemove(function(event){if(item.extend.parameters.mousedown&&this==event.target){_this.$xEditorPlugColorTargetBarAreaAlpha(_this,item,event)}})}).mouseup(function(event){item.extend.parameters.mousedown=false})},$xEditorPlugUpload:function(_this,file,type){var url;var formData=new FormData;formData.append(type,file);$.ajax({type:"POST",url:_this.$option.uploadUrl,data:formData,processData:false,contentType:false,async:false,success:function(e){url=e},error:function(e){console.log(e)}});return url},$plugsBarConfirmButtonClick:function(_this,target,index){if(_this.$range){var selection=window.getSelection();selection.removeAllRanges();selection.addRange(_this.$range);switch(_this.$option.plugs[index]["command"]){case"code":var id=(new Date).getTime()+Math.random().toString().substring(2);document.execCommand("insertHTML",false,'<div class="xEditorCode" id="'+id+'" xEditorCodeTheme="eclipse" xEditorCodeMode="'+_this.$option.plugs[index]["value"]+'"></div>');CodeMirror(document.getElementById(id),{mode:_this.$option.plugs[index]["value"],lineNumbers:true,lineWrapping:false,theme:"eclipse",foldGutter:true,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],selectionStart:"number",selectionEnd:"number",smartIndent:true,indentWithTabs:true,extraKeys:{"Ctrl-Space":"autocomplete"},showCursorWhenSelecting:true});break;case"image":var url=_this.$xEditorPlugUpload(_this,_this.$option.plugs[index]["extend"]["parameters"]["target"]["file"][0].files[0],"file");if(url){var image=new Image;image.src=url;image.onload=function(){document.execCommand("insertHTML",false,'<img style="width: '+image.width/window.devicePixelRatio+"px; height: "+image.height/window.devicePixelRatio+'px;" src="'+url+'">')}}break;default:document.execCommand(_this.$option.plugs[index]["command"],false,_this.$option.plugs[index]["value"]);break}}$(target).parent().parent().hide()},$plugsBarUlButtonClick:function(_this,target,index){if(_this.$option.plugs[index]["value"]==null){var selection=window.getSelection();if(_this.$range=selection.getRangeAt(0)){switch(_this.$option.plugs[index]["command"]){case"tag":if(_this.$range.toString()){document.execCommand("insertHTML",false,"<code style=\"font-family: Menlo, Monaco, Consolas, 'Courier New', monospace; font-size: 12.6px; padding: 2px 4px; color: rgb(199, 37, 78); background-color: rgb(249, 242, 244); border-radius: 4px;\">"+_this.$range+"</code>")}break;case"quote":document.execCommand("insertHTML",false,'<blockquote style="background: #ddd;padding: 8px 8px;margin: 0px;border-left: 3px solid #00a3cf;background: #f6f6f6;"><div><br></div></blockquote>');break;case"preview":$(target).find("i").toggleClass(_this.$option.plugs[index]["icon"].join(" "));if(_this.$option.plugs[index]["icon"].indexOf($(target).find("i").attr("class"))){_this.$content.attr("contenteditable",false)}else{_this.$content.attr("contenteditable",true)}break;case"fullScreen":$(target).find("i").toggleClass(_this.$option.plugs[index]["icon"].join(" "));if(_this.$option.plugs[index]["icon"].indexOf($(target).find("i").attr("class"))){_this.$box.css({position:"absolute"})}else{_this.$box.css({position:""})}break;default:document.execCommand(_this.$option.plugs[index]["command"],false,_this.$option.plugs[index]["value"]);break}}return}if(_this.$plugsBarButtonSelected){$(_this.$plugsBarButtonSelected).hide()}_this.$plugsBarButtonSelected=$(target).parent().next();if(_this.$plugsBarButtonSelected){var x=_this.$element.width()-$(target).position().left-_this.$plugsBarButtonSelected.width();if(x<0){_this.$plugsBarButtonSelected.css({left:$(target).position().left+1+x-_this.$element.position().left-8+26})}_this.$plugsBarButtonSelected.css({top:_this.$plugsBarUl.height()+1+18+"px"});var selection=window.getSelection();_this.$range=selection.getRangeAt(0);_this.$plugsBarButtonSelected.show()}},$xEditorPlugSelectInit:function(_this,extend,item){var select=$('<select style="appearance: none;-moz-appearance: none;-webkit-appearance: none;border-radius: 0px;-webkit-border-radius: 0px;-moz-border-radius: 0px;width: 100%;height: 24px;border: 1px solid #dcdee2;color: #2b85e4;outline: none;background-color: #fff;"></select>');$(extend).children().eq(1).append(select);item.extend.parameters.preSet.forEach(function(option){$(select).append('<option value="'+option.value+'">'+option.name+"</option>")});$(select).change(function(event){var index=$(this).closest("li").index();_this.$option.plugs[index]["value"]=$(this).val()})},$init:function(_this){_this.$element.append('<table border="1" style="left: 0px; top: 0px; margin: 0px; padding: 0px; width: 100%; height: 100%; border: 1px solid #dcdee2; border-collapse: collapse;">'+"<tr>"+'<td style="width: 100%; background-color: #f8f8f9; margin: 0px; padding: 0px; ">'+'<ul style="z-index: 1; margin: 0px; padding: 0px; list-style: none;line-height: 26px;margin: 0px;padding: 0px;user-select: none;"></ul>'+"</td>"+"</tr>"+'<tr style="height: 100%;">'+'<td style="padding: 8px; margin: 0px;">'+'<div style="z-index: 0; margin: 0px; padding: 0px; width: 100%; height: 100%; outline: none; background-color: #fff; overflow-y: auto; font-size: 12px; color: #515a6e; word-break: break-word;" contenteditable="true"></div>'+"</td>"+"</tr>"+"</table>");_this.$box=_this.$element.find(" > table:first-child");_this.$plugsBarUl=_this.$element.find(" ul:first-child");_this.$content=_this.$element.find(" div:first-child");_this.$content.focus();_this.$option.plugs.forEach(function(item){var toolbar=$('<li style="display: inline-block">'+'<div style="display: inline-block">'+'<div style="display: inline-block">'+"<button onmouseleave=\"this.style.color = '#515a6e'; this.style.backgroundColor = '#f8f8f9'\" onmouseenter=\"this.style.color = '#19be6b'; this.style.backgroundColor = '#e8eaec'\" title=\""+item.title+'" style="margin: 0px;padding: 0px;width: 30px;height: 30px;border-radius: 0px;border: none;outline: none;background-color: #f8f8f9;color: #515a6e;font-size: 12px;line-height: 26px;">'+'<i class="'+item.icon[0]+'" style="font-size: 14px;"></i>'+"</button>"+"</div>"+"</div>"+"</li>");_this.$plugsBarUl.append(toolbar);if(Object.keys(item.extend).length){var extend=$('<div style="z-index: 1; position: absolute;margin-left: -1px;width: 238px;height: auto;border: 1px solid #dcdee2;background-color: #f8f8f9;font-size: 12px;padding: 8px;" hidden>'+'<div style="height: 20px;line-height: 20px;">'+item.title+"</div>"+'<div style="padding: 8px 0px;"></div>'+'<div style="text-align: left;padding-bottom: 5px;">'+'<button style="width: 50px;background-color: #19be6b;color: #fff;font-size: 12px;line-height: 20px;border: none;cursor: pointer;outline: none;">确定</button>'+"</div>"+"</div>");$(toolbar).children().eq(0).append(extend);switch(item.extend.name){case"select":_this.$xEditorPlugSelectInit(_this,extend,item);break;case"color":_this.$xEditorPlugColorInit(_this,extend,item);break;case"image":_this.$xEditorPlugImageInit(_this,extend,item);break;case"input":_this.$xEditorPlugInputInit(_this,extend,item);break;default:break}}});_this.$plugsBarUlButton=_this.$element.find(" ul:first-child > li > div:first-child > div:first-child > button");_this.$plugsBarUlButton.click(function(){var index=$(this).closest("li").index();_this.$plugsBarUlButtonClick(_this,this,index)});_this.$plugsBarConfirmButton=_this.$element.find(" ul:first-child > li > div:first-child > div:nth-child(2) > div:last-child > button");_this.$plugsBarConfirmButton.click(function(){var index=$(this).closest("li").index();_this.$plugsBarConfirmButtonClick(_this,this,index)});_this.$content.bind("paste",function(event){_this.$xEditorContentPaste(_this,event)})}};$.fn.xEditor=function(option){new xEditor(this,option)}}(jQuery);